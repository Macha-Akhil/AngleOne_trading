[E 240314 10:19:19 operations:110] Error fetching historical data: single positional indexer is out-of-bounds
    Traceback (most recent call last):
      File "c:\Users\user\Documents\angleOne_trading\operations.py", line 82, in get_index_info
        index_instrument_token = getTokenInfo('NSE','',index,'','','').iloc[0]['token']
                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\indexing.py", line 1103, in __getitem__
        return self._getitem_axis(maybe_callable, axis=axis)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\indexing.py", line 1656, in _getitem_axis
        self._validate_integer(key, axis)
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\pandas\core\indexing.py", line 1589, in _validate_integer
        raise IndexError("single positional indexer is out-of-bounds")
    IndexError: single positional indexer is out-of-bounds
[E 240314 13:05:03 operations:203] Error fetching historical data: HTTPSConnectionPool(host='apiconnect.angelbroking.com', port=443): Max retries exceeded with url: /rest/secure/angelbroking/historical/v1/getCandleData (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x000001CF1B2B5850>, 'Connection to apiconnect.angelbroking.com timed out. (connect timeout=7)'))
    Traceback (most recent call last):
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\urllib3\connection.py", line 203, in _new_conn
        sock = connection.create_connection(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\urllib3\util\connection.py", line 85, in create_connection
        raise err
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\urllib3\util\connection.py", line 73, in create_connection
        sock.connect(sa)
    TimeoutError: timed out
    
    The above exception was the direct cause of the following exception:
    
    Traceback (most recent call last):
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\urllib3\connectionpool.py", line 791, in urlopen
        response = self._make_request(
                   ^^^^^^^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\urllib3\connectionpool.py", line 492, in _make_request
        raise new_e
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\urllib3\connectionpool.py", line 468, in _make_request
        self._validate_conn(conn)
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\urllib3\connectionpool.py", line 1097, in _validate_conn
        conn.connect()
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\urllib3\connection.py", line 611, in connect
        self.sock = sock = self._new_conn()
                           ^^^^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\urllib3\connection.py", line 212, in _new_conn
        raise ConnectTimeoutError(
    urllib3.exceptions.ConnectTimeoutError: (<urllib3.connection.HTTPSConnection object at 0x000001CF1B2B5850>, 'Connection to apiconnect.angelbroking.com timed out. (connect timeout=7)')
    
    The above exception was the direct cause of the following exception:
    
    Traceback (most recent call last):
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\requests\adapters.py", line 486, in send
        resp = conn.urlopen(
               ^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\urllib3\connectionpool.py", line 845, in urlopen
        retries = retries.increment(
                  ^^^^^^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\urllib3\util\retry.py", line 515, in increment
        raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    urllib3.exceptions.MaxRetryError: HTTPSConnectionPool(host='apiconnect.angelbroking.com', port=443): Max retries exceeded with url: /rest/secure/angelbroking/historical/v1/getCandleData (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x000001CF1B2B5850>, 'Connection to apiconnect.angelbroking.com timed out. (connect timeout=7)'))
    
    During handling of the above exception, another exception occurred:
    
    Traceback (most recent call last):
      File "c:\Users\user\Documents\angleOne_trading\operations.py", line 195, in get_strike_lowprice
        index_historical_data = smartApi.getCandleData(params_ce_pe)
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\SmartApi\smartConnect.py", line 430, in getCandleData
        getCandleDataResponse=self._postRequest("api.candle.data",historicDataParams)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\SmartApi\smartConnect.py", line 228, in _postRequest
        return self._request(route, "POST", params)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\SmartApi\smartConnect.py", line 188, in _request
        raise e
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\SmartApi\smartConnect.py", line 177, in _request
        r = requests.request(method,
            ^^^^^^^^^^^^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\requests\api.py", line 59, in request
        return session.request(method=method, url=url, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\requests\sessions.py", line 589, in request
        resp = self.send(prep, **send_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\requests\sessions.py", line 703, in send
        r = adapter.send(request, **kwargs)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\requests\adapters.py", line 507, in send
        raise ConnectTimeout(e, request=request)
    requests.exceptions.ConnectTimeout: HTTPSConnectionPool(host='apiconnect.angelbroking.com', port=443): Max retries exceeded with url: /rest/secure/angelbroking/historical/v1/getCandleData (Caused by ConnectTimeoutError(<urllib3.connection.HTTPSConnection object at 0x000001CF1B2B5850>, 'Connection to apiconnect.angelbroking.com timed out. (connect timeout=7)'))
[E 240314 13:05:39 operations:203] Error fetching historical data: ('Connection broken: IncompleteRead(7732872 bytes read, 14872519 more expected)', IncompleteRead(7732872 bytes read, 14872519 more expected))
    Traceback (most recent call last):
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\urllib3\response.py", line 710, in _error_catcher
        yield
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\urllib3\response.py", line 835, in _raw_read
        raise IncompleteRead(self._fp_bytes_read, self.length_remaining)
    urllib3.exceptions.IncompleteRead: IncompleteRead(7732872 bytes read, 14872519 more expected)
    
    The above exception was the direct cause of the following exception:
    
    Traceback (most recent call last):
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\requests\models.py", line 816, in generate
        yield from self.raw.stream(chunk_size, decode_content=True)
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\urllib3\response.py", line 936, in stream
        data = self.read(amt=amt, decode_content=decode_content)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\urllib3\response.py", line 907, in read
        data = self._raw_read(amt)
               ^^^^^^^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\urllib3\response.py", line 813, in _raw_read
        with self._error_catcher():
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\contextlib.py", line 155, in __exit__
        self.gen.throw(typ, value, traceback)
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\urllib3\response.py", line 727, in _error_catcher
        raise ProtocolError(f"Connection broken: {e!r}", e) from e
    urllib3.exceptions.ProtocolError: ('Connection broken: IncompleteRead(7732872 bytes read, 14872519 more expected)', IncompleteRead(7732872 bytes read, 14872519 more expected))
    
    During handling of the above exception, another exception occurred:
    
    Traceback (most recent call last):
      File "c:\Users\user\Documents\angleOne_trading\operations.py", line 139, in get_strike_lowprice
        intializeSymbolTokenMap()
      File "c:\Users\user\Documents\angleOne_trading\operations.py", line 39, in intializeSymbolTokenMap
        d = requests.get(url).json()
            ^^^^^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\requests\api.py", line 73, in get
        return request("get", url, params=params, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\requests\api.py", line 59, in request
        return session.request(method=method, url=url, **kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\requests\sessions.py", line 589, in request
        resp = self.send(prep, **send_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\requests\sessions.py", line 747, in send
        r.content
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\requests\models.py", line 899, in content
        self._content = b"".join(self.iter_content(CONTENT_CHUNK_SIZE)) or b""
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
      File "C:\Users\user\AppData\Local\Programs\Python\Python311\Lib\site-packages\requests\models.py", line 818, in generate
        raise ChunkedEncodingError(e)
    requests.exceptions.ChunkedEncodingError: ('Connection broken: IncompleteRead(7732872 bytes read, 14872519 more expected)', IncompleteRead(7732872 bytes read, 14872519 more expected))
